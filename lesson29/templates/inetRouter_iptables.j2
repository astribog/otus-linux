# Generated by iptables-save v1.4.21 on Fri May 12 12:18:37 2023
*nat
:PREROUTING ACCEPT [307:18324]
:INPUT ACCEPT [9:540]
:OUTPUT ACCEPT [88:6780]
:POSTROUTING ACCEPT [1:168]
-A POSTROUTING -o eth0 -j MASQUERADE
COMMIT
# Completed on Fri May 12 12:18:37 2023
# Generated by iptables-save v1.4.21 on Fri May 12 12:18:37 2023
*filter
:INPUT ACCEPT [0:0]
:FORWARD ACCEPT [4:304]
:OUTPUT ACCEPT [179:21993]
:STATE0 - [0:0]
:STATE1 - [0:0]
:STATE2 - [0:0]
:STATE3 - [0:0]
-A INPUT -m state --state RELATED,ESTABLISHED -j ACCEPT
-A INPUT -p icmp -j ACCEPT
-A INPUT -i lo -j ACCEPT
-A INPUT -i eth1 -m recent --rcheck --name KNOCK3 --mask 255.255.255.255 --rsource -j STATE3
-A INPUT -i eth1 -m recent --rcheck --name KNOCK2 --mask 255.255.255.255 --rsource -j STATE2
-A INPUT -i eth1 -m recent --rcheck --name KNOCK1 --mask 255.255.255.255 --rsource -j STATE1
-A INPUT -i eth1 -j STATE0
-A INPUT
-A STATE0 -i eth1 -p udp -m udp --dport 12345 -m recent --set --name KNOCK1 --mask 255.255.255.255 --rsource -j DROP
-A STATE0 -i eth1 -j DROP
-A STATE1 -i eht1 -m recent --remove --name KNOCK1 --mask 255.255.255.255 --rsource
-A STATE1 -i eth1 -p udp -m udp --dport 23456 -m recent --set --name KNOCK2 --mask 255.255.255.255 --rsource -j DROP
-A STATE1 -i eth1 -j STATE0
-A STATE2 -i eth1 -m recent --remove --name KNOCK2 --mask 255.255.255.255 --rsource
-A STATE2 -i eth1 -p udp -m udp --dport 34567 -m recent --set --name KNOCK3 --mask 255.255.255.255 --rsource -j DROP
-A STATE2 -i eth1 -j STATE0
-A STATE3 -i eth1 -m recent --remove --name KNOCK3 --mask 255.255.255.255 --rsource
-A STATE3 -i eth1 -p tcp -m tcp --dport 22 -j ACCEPT
-A STATE3 -i eth1 -j STATE0
COMMIT
# Completed on Fri May 12 12:18:37 2023